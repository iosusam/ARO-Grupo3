<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>Buscar</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
        <link rel="stylesheet" type="text/css" href="templates/estilosBuscar.css" />
        <script
            src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false">
        </script>
        <script>
            function initialize(){
                var myLatLng = new google.maps.LatLng(42.815766, -1.646073);
                var mapOptions = {
                    zoom: 14,
                    center: myLatLng,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                var map = new google.maps.Map(document.getElementById('map-canvas'),
                mapOptions);
            }
            
            var con;

            function conexion()
            {
                if (window.ActiveXObject)
                {
                    con = new ActiveXObject("Microsoft.XMLHTTP");
                }
                else
                {
                    if (window.XMLHttpRequest)
                    {
                            con = new XMLHttpRequest();
                    }
                }
            }
            
            function obtenercoordenadasrestaurantes(){
                conexion();
                con.onreadystatechange = respuestacoordenadasrestaurantes;
                var dir = "index.php?accion=buscar&id=2&variable=" + Math.random();
                con.open("GET", dir, true);
                con.send(null);
            }
            
            function obtenercoordenadaszonaazul(){
                conexion();
                con.onreadystatechange = respuestacoordenadaszonaazul;
                var dir = "index.php?accion=buscar&id=5&variable=" + Math.random();
                con.open("GET", dir, true);
                con.send(null);
            }
            
            function obtenercoordenadaszonaroja(){
                conexion();
                con.onreadystatechange = respuestacoordenadaszonaroja;
                var dir = "index.php?accion=buscar&id=6&variable=" + Math.random();
                con.open("GET", dir, true);
                con.send(null);
            }
            
            function obtenercoordenadaszonaverde(){
                conexion();
                con.onreadystatechange = respuestacoordenadaszonaverde;
                var dir = "index.php?accion=buscar&id=7&variable=" + Math.random();
                con.open("GET", dir, true);
                con.send(null);
            }
            
            function respuestacoordenadasrestaurantes()
            {
                if (con.readyState == 4)
                {
                    if (con.status == 200)
                    {
                        var array = con.responseText;
                        
                        var marcadores = JSON.parse(array);
                        
                        var myLatLng = new google.maps.LatLng(42.815766, -1.646073);
                        var mapOptions = {
                            zoom: 14,
                            center: myLatLng,
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        
                        var map = new google.maps.Map(document.getElementById('map-canvas'),
                        mapOptions);
                        var img = new google.maps.MarkerImage("imagenes/marcaRestaurantes.png");
                        var infowindow = new google.maps.InfoWindow({  
                            content: ''
                        });
                        for (var i = 0, j = Object.keys(marcadores).length; i < j; i++) {  
                            var contenido = marcadores[i].Contenido;
                            var marker = new google.maps.Marker({
                              position: new google.maps.LatLng(marcadores[i].X, marcadores[i].Y),
                              map: map,
                              icon: img
                            });
                            (function(marker, contenido) {
                              google.maps.event.addListener(marker, 'click', function() {
                                infowindow.setContent(contenido);
                                infowindow.open(map, marker);
                              });
                            })(marker, contenido);
                        }
                    }
                }
            }
            
            function obtenercoordenadasaparcamientosgratuitos()
            {
                conexion();
                con.onreadystatechange = respuestacoordenadasaparcamientos;
                var dir = "index.php?accion=buscar&id=3&variable=" + Math.random();
                con.open("GET", dir, true);
                con.send(null);
            }
            
            function obtenercoordenadasaparcamientosdepago()
            {
                conexion();
                con.onreadystatechange = respuestacoordenadasaparcamientos;
                var dir = "index.php?accion=buscar&id=4&variable=" + Math.random();
                con.open("GET", dir, true);
                con.send(null);
            }
            
            function respuestacoordenadasaparcamientos()
            {
                if (con.readyState == 4)
                {
                    if (con.status == 200)
                    {
                        var array = con.responseText;
                        
                        var marcadores = JSON.parse(array);
                        
                        var myLatLng = new google.maps.LatLng(42.815766, -1.646073);
                        var mapOptions = {
                            zoom: 14,
                            center: myLatLng,
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        
                        var map = new google.maps.Map(document.getElementById('map-canvas'),
                        mapOptions);
                        var img = new google.maps.MarkerImage("imagenes/marcaParkings.png");
                        var infowindow = new google.maps.InfoWindow({  
                            content: ''
                        });
                        for (var i = 0, j = Object.keys(marcadores).length; i < j; i++) {  
                            var contenido = marcadores[i].Contenido;
                            var marker = new google.maps.Marker({
                              position: new google.maps.LatLng(marcadores[i].X, marcadores[i].Y),
                              map: map,
                              icon: img
                            });
                            (function(marker, contenido) {
                              google.maps.event.addListener(marker, 'click', function() {
                                infowindow.setContent(contenido);
                                infowindow.open(map, marker);
                              });
                            })(marker, contenido);
                        }
                    }
                }
            }
            
            function respuestacoordenadaszonaazul()
            {
                if (con.readyState == 4)
                {
                    if (con.status == 200)
                    {
                        var array = con.responseText;
                        var puntos = JSON.parse(array);                       
                        var myLatLng = new google.maps.LatLng(42.815766, -1.646073);
                        var mapOptions = {
                            zoom: 14,
                            center: myLatLng,
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        
                        var map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);                                
                        var i = 0;
                        var j = Object.keys(puntos).length;

                        while(i<j-1) {
                            var poligGMCoords = [];
                            var nombre = puntos[i].Nombre;
                            
                            while((nombre === puntos[i].Nombre) && (i<j-1)){
                                var latlong = new google.maps.LatLng(puntos[i].X, puntos[i].Y);
                                poligGMCoords.push(latlong);
                                i++;
                            }   
                            var zonaAzul = new google.maps.Polygon({
                                paths: poligGMCoords,
                                strokeColor: "#3399FF",
                                strokeOpacity: 0.8,
                                strokeWeight: 2,
                                fillColor: "#33CCCC",
                                fillOpacity: 0.35
                            });
                            zonaAzul.setMap(map);
                        }
                        
                    }
                }
            }
            
            function respuestacoordenadaszonaroja()
            {
                if (con.readyState == 4)
                {
                    if (con.status == 200)
                    {
                        var array = con.responseText;
                        var puntos = JSON.parse(array);                       
                        var myLatLng = new google.maps.LatLng(42.815766, -1.646073);
                        var mapOptions = {
                            zoom: 14,
                            center: myLatLng,
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        
                        var map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);                                
                        var i = 0;
                        var j = Object.keys(puntos).length;

                        while(i<j-1) {
                            var poligGMCoords = [];
                            var nombre = puntos[i].Nombre;
                            
                            while((nombre === puntos[i].Nombre) && (i<j-1)){
                                var latlong = new google.maps.LatLng(puntos[i].X, puntos[i].Y);
                                poligGMCoords.push(latlong);
                                i++;
                            }       
                            var zonaRoja = new google.maps.Polygon({
                                paths: poligGMCoords,
                                strokeColor: '#FF0000',
                                strokeOpacity: 0.8,
                                strokeWeight: 2,
                                fillColor: '#FF0000',
                                fillOpacity: 0.35
                            });
                            zonaRoja.setMap(map);                        
                        }
                        
                    }
                }
            }
            
            function respuestacoordenadaszonaverde()
            {
                if (con.readyState == 4)
                {
                    if (con.status == 200)
                    {
                        var array = con.responseText;
                        var puntos = JSON.parse(array);                       
                        var myLatLng = new google.maps.LatLng(42.815766, -1.646073);
                        var mapOptions = {
                            zoom: 14,
                            center: myLatLng,
                            mapTypeId: google.maps.MapTypeId.ROADMAP
                        };
                        
                        var map = new google.maps.Map(document.getElementById('map-canvas'),mapOptions);                                
                        var i = 0;
                        var j = Object.keys(puntos).length;

                        while(i<j-1) {
                            var poligGMCoords = [];
                            var nombre = puntos[i].Nombre;
                            
                            while((nombre === puntos[i].Nombre) && (i<j-1)){
                                var latlong = new google.maps.LatLng(puntos[i].X, puntos[i].Y);
                                poligGMCoords.push(latlong);
                                i++;
                            }       
                            var zonaVerde = new google.maps.Polygon({
                                paths: poligGMCoords,
                                strokeColor: '#04B404',
                                strokeOpacity: 0.8,
                                strokeWeight: 2,
                                fillColor: '#00FF00',
                                fillOpacity: 0.35
                            });
                            zonaVerde.setMap(map);                        
                        }
                        
                    }
                }
            }
            
            google.maps.event.addDomListener(window, 'load', initialize);
        </script>
    </head>
    
    <body>
        <nav class="navbar navbar-default margenCabecera" role="navigation">
            <!-- El logotipo y el icono que despliega el menú se agrupan
                 para mostrarlos mejor en los dispositivos móviles -->
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse"
                      data-target=".navbar-ex1-collapse">
                <span class="sr-only">Desplegar navegación</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="index.php">Park-Eat</a>
            </div>

            <!-- Agrupar los enlaces de navegación, los formularios y cualquier
                 otro elemento que se pueda ocultar al minimizar la barra -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
              <ul class="nav navbar-nav">
                <li><a href="index.php">Inicio</a></li>
                <li><a href="templates/contacto.html">Contacto</a></li>
                <li><a href="templates/acercade.html">¿Quienes somos?</a></li>
              </ul>

              <ul class="nav navbar-nav navbar-right">
                <li><a href="index.php?accion=login&id=1">Log In</a></li>
                <li><a href="index.php?accion=registro&id=1">Regístrate</a></li>
              </ul>
            </div>
        </nav>
        <h1 class="center-block">
            Encuentra tu restaurante
        </h1>
        <br><br>
        <h4 class="center-text">Encuentra tu restuarante junto con el parking más cercano</h4>
        <br>
        
        <div class="container">
            <div id="map-canvas" class="center-block"></div>
        
            <button class="btn btn-warning" onclick="window.location.href='javascript:obtenercoordenadasrestaurantes()'">Restaurantes</button>
            <button class="btn btn-info" onclick="window.location.href='javascript:obtenercoordenadasaparcamientosgratuitos()'">Aparcamientos gratuitos</button>
            <button class="btn btn-info" onclick="window.location.href='javascript:obtenercoordenadasaparcamientosdepago()'">Aparcamientos de pago</button>
            <button class="btn btn-primary pull-right" onclick="window.location.href='javascript:obtenercoordenadaszonaazul()'">Zona Azul</button>
            <button class="btn btn-danger pull-right" id="botones" onclick="window.location.href='javascript:obtenercoordenadaszonaroja()'">Zona Roja</button>
            <button class="btn btn-success pull-right" id="botones" onclick="window.location.href='javascript:obtenercoordenadaszonaverde()'">Zona Verde</button>
        </div>
        
        <footer class="footer navbar-bottom" >
            <div class="container">
                <br/>
                <p class="text-muted margen text-center"><span>© Park-Eat 2015</span></p>
            </div>
        </footer>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    </body>
</html>
